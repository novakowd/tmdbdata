<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>tmdbdata ‚Ä¢ tmdbdata</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="tmdbdata">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tmdbdata</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/tmdbdata.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/imdb_data.html">imdb_data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>tmdbdata</h1>
            
      

      <div class="d-none name"><code>tmdbdata.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://novakowd.github.io/tmdbdata/">tmdbdata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://httr2.r-lib.org" class="external-link">httr2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="tmdb-data-functions-with-httr2functions">TMDB data functions with <code>httr2::functions()</code><a class="anchor" aria-label="anchor" href="#tmdb-data-functions-with-httr2functions"></a>
</h2>
<p>This Package uses <a href="https://httr2.r-lib.org/articles/wrapping-apis.html" class="external-link"><strong><code>httr2</code>
package</strong></a> functions to generate and perform requests then
extract results from the response body.</p>
<div class="section level3">
<h3 id="create-basic-request">Create Basic Request<a class="anchor" aria-label="anchor" href="#create-basic-request"></a>
</h3>
<p>A <strong><code>base_tmdb_request</code></strong> is constructed by
looking at settings found in the <a href="https://developer.themoviedb.org/docs/rate-limiting" class="external-link"><strong>API
documentation</strong></a>.</p>
<p>For example:</p>
<ul>
<li>
<strong><code><a href="https://httr2.r-lib.org/reference/req_headers.html" class="external-link">httr2::req_headers()</a></code></strong> info in the <a href="https://developer.themoviedb.org/docs/json-and-jsonp" class="external-link"><strong>Response
Format</strong></a> and <a href="https://developer.themoviedb.org/docs/authentication-application" class="external-link"><strong>Authentication</strong></a>
Documentation.<br>
</li>
<li>
<strong><code><a href="https://httr2.r-lib.org/reference/req_throttle.html" class="external-link">httr2::req_throttle()</a></code></strong> info in the <a href="https://developer.themoviedb.org/docs/rate-limiting" class="external-link"><strong>Rate
Limits Documentation</strong></a>
</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">base_tmdb_request</span></span>
<span><span class="co">#&gt; function (auth_token = get_auth_token()) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     httr2::request("https://api.themoviedb.org/3/") %&gt;% httr2::req_headers(accept = "application/json", </span></span>
<span><span class="co">#&gt;         Authorization = paste("Bearer", auth_token), .redact = "Authorization") %&gt;% </span></span>
<span><span class="co">#&gt;         httr2::req_error(body = tmdb_error_body) %&gt;% httr2::req_user_agent("tmdbdata (https://github.com/novakowd/tmdbdata)") %&gt;% </span></span>
<span><span class="co">#&gt;         httr2::req_throttle(rate = 40, realm = "https://api.themoviedb.org/3/")</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x55f3cd29b620&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: namespace:tmdbdata&gt;</span></span></code></pre></div>
<blockquote>
<table class="table">
<colgroup>
<col width="1%">
<col width="98%">
</colgroup>
<thead><tr class="header">
<th>üìù</th>
<th align="left">default of <code>auth_token = get_auth_token()</code>,
will <strong>only</strong> work after the environment variable has been
setup as mentioned in <a href="https://novakowd.github.io/tmdbdata/#authentication"><strong>Authentication</strong></a>
</th>
</tr></thead>
<tbody></tbody>
</table>
</blockquote>
<p>The <code>Authorization</code> header info is also redacted in the
following objects.</p>
<hr>
<p>Running the above <code><a href="../reference/base_tmdb_request.html">base_tmdb_request()</a></code> function generates
a basic <code>&lt;httr2_request&gt;</code> object:</p>
<ul>
<li>Normally <code>auth_token</code> should not need to be specified if
the <a href="https://novakowd.github.io/tmdbdata/#authentication">Authentication</a>
steps were followed</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">base_request</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/base_tmdb_request.html">base_tmdb_request</a></span><span class="op">(</span>auth_token <span class="op">=</span> <span class="fu"><a href="../reference/decrypt_auth_token.html">decrypt_auth_token</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">base_request</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;httr2_request&gt;</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">GET</span> https://api.themoviedb.org/3/</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Headers:</span></span></span>
<span><span class="co">#&gt; ‚Ä¢ <span style="color: #00BB00;">accept       </span>: "application/json"</span></span>
<span><span class="co">#&gt; ‚Ä¢ <span style="color: #00BB00;">Authorization</span>: <span style="color: #555555;">&lt;REDACTED&gt;</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Body</span>: empty</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Options:</span></span></span>
<span><span class="co">#&gt; ‚Ä¢ <span style="color: #00BB00;">useragent</span>: "tmdbdata (https://github.com/novakowd/tmdbdata)"</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Policies:</span></span></span>
<span><span class="co">#&gt; ‚Ä¢ <span style="color: #00BB00;">error_body    </span>: &lt;function&gt;</span></span>
<span><span class="co">#&gt; ‚Ä¢ <span style="color: #00BB00;">throttle_realm</span>: "https://api.themoviedb.org/3/"</span></span></code></pre></div>
<p>The functions <code><a href="https://httr2.r-lib.org/reference/req_headers.html" class="external-link">req_headers()</a></code>, <code><a href="https://httr2.r-lib.org/reference/req_error.html" class="external-link">req_error()</a></code>,
<code><a href="https://httr2.r-lib.org/reference/req_user_agent.html" class="external-link">req_user_agent()</a></code>, and <code><a href="https://httr2.r-lib.org/reference/req_throttle.html" class="external-link">req_throttle()</a></code> do NOT
change the URL <code>https://api.themoviedb.org/3/</code>, but they DO
add other elements to the request such as <code>Headers</code>,
<code>Options</code>, and <code>Policies</code>.</p>
<hr>
</div>
<div class="section level3">
<h3 id="append-request-details">Append Request Details<a class="anchor" aria-label="anchor" href="#append-request-details"></a>
</h3>
<p>The next step is to append a path to the base URL and add relevant
arguments to help with the request. Find appropriate arguments by
consulting the API Documentation.</p>
<p>The below example looks at the <a href="https://developer.themoviedb.org/reference/search-movie" class="external-link"><strong>Search&gt;Movie
Documentation</strong></a> which states:</p>
<ul>
<li>there is a <strong>required</strong> parameter called
<strong><code>query</code></strong> and,</li>
<li>some other <em>optional</em> parameters, some of which have default
values.</li>
</ul>
<p>Let‚Äôs try putting together a request to
<strong><code>search</code></strong> the
<strong><code>movies</code></strong> for
<strong><code>Avengers</code></strong>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">base_request</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://httr2.r-lib.org/reference/req_url.html" class="external-link">req_url_path_append</a></span><span class="op">(</span><span class="st">"search"</span>,<span class="st">"movie"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://httr2.r-lib.org/reference/req_url.html" class="external-link">req_url_query</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Avengers"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;httr2_request&gt;</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">GET</span> https://api.themoviedb.org/3/search/movie?query=Avengers</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Headers:</span></span></span>
<span><span class="co">#&gt; ‚Ä¢ <span style="color: #00BB00;">accept       </span>: "application/json"</span></span>
<span><span class="co">#&gt; ‚Ä¢ <span style="color: #00BB00;">Authorization</span>: <span style="color: #555555;">&lt;REDACTED&gt;</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Body</span>: empty</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Options:</span></span></span>
<span><span class="co">#&gt; ‚Ä¢ <span style="color: #00BB00;">useragent</span>: "tmdbdata (https://github.com/novakowd/tmdbdata)"</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Policies:</span></span></span>
<span><span class="co">#&gt; ‚Ä¢ <span style="color: #00BB00;">error_body    </span>: &lt;function&gt;</span></span>
<span><span class="co">#&gt; ‚Ä¢ <span style="color: #00BB00;">throttle_realm</span>: "https://api.themoviedb.org/3/"</span></span></code></pre></div>
<blockquote>
<p>The functions <code><a href="https://httr2.r-lib.org/reference/req_url.html" class="external-link">req_url_path_append()</a></code> and
<code><a href="https://httr2.r-lib.org/reference/req_url.html" class="external-link">req_url_query()</a></code> modified the url to <a href="https://api.themoviedb.org/3/search/movie?query=Avengers" class="external-link uri">https://api.themoviedb.org/3/search/movie?query=Avengers</a></p>
</blockquote>
<hr>
</div>
<div class="section level3">
<h3 id="perform-request">Perform Request<a class="anchor" aria-label="anchor" href="#perform-request"></a>
</h3>
<p>Now that we have built a request,
<strong><code><a href="https://httr2.r-lib.org/reference/req_perform.html" class="external-link">httr2::req_perform()</a></code></strong> allows us to get a
<code>response</code>.</p>
<ul>
<li>
<strong><code><a href="https://httr2.r-lib.org/reference/req_perform.html" class="external-link">httr2::req_perform()</a></code></strong> submits the
request to the server
<ul>
<li><pre><code>assigning to a `variable` stores the response in-memory, as to not exceed the API's [Rate Limits](https://developer.themoviedb.org/docs/rate-limiting)</code></pre></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">response</span> <span class="op">&lt;-</span> <span class="va">base_request</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://httr2.r-lib.org/reference/req_url.html" class="external-link">req_url_path_append</a></span><span class="op">(</span><span class="st">"search"</span>, <span class="st">"movie"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://httr2.r-lib.org/reference/req_url.html" class="external-link">req_url_query</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Avengers"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://httr2.r-lib.org/reference/req_perform.html" class="external-link">req_perform</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">response</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;httr2_response&gt;</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">GET</span> https://api.themoviedb.org/3/search/movie?query=Avengers</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Status</span>: 200 OK</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Content-Type</span>: application/json</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Body</span>: In memory (11767 bytes)</span></span></code></pre></div>
<div class="section level4">
<h4 id="response-structure">Response Structure<a class="anchor" aria-label="anchor" href="#response-structure"></a>
</h4>
<p>Printing the <code>&lt;httr2_response&gt;</code> object above does
not show much information, though more information is available when
inspecting closer:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "httr2_response"</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">response</span>,<span class="va">class</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">response</span>,<span class="va">length</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     class length</span></span>
<span><span class="co">#&gt; method          character      1</span></span>
<span><span class="co">#&gt; url             character      1</span></span>
<span><span class="co">#&gt; status_code       integer      1</span></span>
<span><span class="co">#&gt; headers     httr2_headers     18</span></span>
<span><span class="co">#&gt; body                  raw  11767</span></span>
<span><span class="co">#&gt; request     httr2_request      8</span></span>
<span><span class="co">#&gt; cache         environment      0</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">response</span><span class="op">$</span><span class="va">headers</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "content-type"     "date"             "etag"             "content-encoding"</span></span>
<span><span class="co">#&gt;  [5] "server"           "cache-control"    "x-memc"           "x-memc-key"      </span></span>
<span><span class="co">#&gt;  [9] "x-memc-age"       "x-memc-expires"   "vary"             "x-cache"         </span></span>
<span><span class="co">#&gt; [13] "via"              "x-amz-cf-pop"     "alt-svc"          "x-amz-cf-id"     </span></span>
<span><span class="co">#&gt; [17] "age"              "vary"</span></span></code></pre></div>
<p>The actual ‚ÄòData‚Äô that we‚Äôre looking for is in the <code>$body</code>
element, though it is not in a usable format yet:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">response</span><span class="op">$</span><span class="va">body</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  raw [1:11767] 7b 22 70 61 ...</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="response-body">Response Body<a class="anchor" aria-label="anchor" href="#response-body"></a>
</h3>
<p><a href="https://httr2.r-lib.org/" class="external-link"><strong><code>httr2</code></strong></a>
provides many <a href="https://httr2.r-lib.org/reference/resp_body_raw.html" class="external-link"><code>resp_body_*()</code></a>
functions to extract the <code>body</code> data, depending on the API
response format(s).<br>
The <a href="https://developer.themoviedb.org/docs/json-and-jsonp" class="external-link"><strong>API
Documentation</strong></a> states the <strong>only supported response
format is <code>JSON</code></strong>, so we use the
<strong><code><a href="https://httr2.r-lib.org/reference/resp_body_raw.html" class="external-link">resp_body_json()</a></code></strong> function and use the
<code>simplifyVector = T</code> to make the resulting lists easier to
work with.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">body</span> <span class="op">&lt;-</span> <span class="va">response</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://httr2.r-lib.org/reference/resp_body_raw.html" class="external-link">resp_body_json</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Inspecting the body shows it is a list with 4 elements.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">body</span>, <span class="va">class</span><span class="op">)</span></span>
<span><span class="co">#&gt; $page</span></span>
<span><span class="co">#&gt; [1] "integer"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $results</span></span>
<span><span class="co">#&gt; [1] "list"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $total_pages</span></span>
<span><span class="co">#&gt; [1] "integer"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $total_results</span></span>
<span><span class="co">#&gt; [1] "integer"</span></span></code></pre></div>
<p>The <code>$page</code>, <code>$total_pages</code>, and
<code>$total_results</code> elements are all <code>integer</code>
values:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">body</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"page"</span>, <span class="st">"total_pages"</span>, <span class="st">"total_results"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; $page</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $total_pages</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $total_results</span></span>
<span><span class="co">#&gt; [1] 127</span></span></code></pre></div>
<p>The <code>$results</code> element is a nested list from the
<code>json</code> response which then uses
<code><a href="https://tidyr.tidyverse.org/reference/unnest_wider.html" class="external-link">tidyr::unnest_wider()</a></code> to clean the data and get a result in
a data frame (<code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble()</a></code>)</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>results <span class="op">=</span> <span class="va">body</span><span class="op">$</span><span class="va">results</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest_wider.html" class="external-link">unnest_wider</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 20</span></span>
<span><span class="co">#&gt; Columns: 14</span></span>
<span><span class="co">#&gt; $ adult             <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FAL‚Ä¶</span></span>
<span><span class="co">#&gt; $ backdrop_path     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "/Al127H6f1RXpESdg0MGNL2g8mzO.jpg"<span style="color: #949494;">, </span>"/mDfJG3LC3Dqb67‚Ä¶</span></span>
<span><span class="co">#&gt; $ genre_ids         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> [16, 35, 878]<span style="color: #949494;">, </span>[12, 28, 878]<span style="color: #949494;">, </span>[878, 28, 12]<span style="color: #949494;">, </span>[28, 1‚Ä¶</span></span>
<span><span class="co">#&gt; $ id                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1359227<span style="color: #949494;">, </span>299536<span style="color: #949494;">, </span>24428<span style="color: #949494;">, </span>40081<span style="color: #949494;">, </span>257346<span style="color: #949494;">, </span>1154598<span style="color: #949494;">, </span>2995‚Ä¶</span></span>
<span><span class="co">#&gt; $ original_language <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "en"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"zh"<span style="color: #949494;">, </span>"ja"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"en"‚Ä¶</span></span>
<span><span class="co">#&gt; $ original_title    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "LEGO Marvel Avengers: Mission Demolition"<span style="color: #949494;">, </span>"Avenger‚Ä¶</span></span>
<span><span class="co">#&gt; $ overview          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A young, aspiring hero and superhero fan inadverten‚Ä¶</span></span>
<span><span class="co">#&gt; $ popularity        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4.7625<span style="color: #949494;">, </span>34.6673<span style="color: #949494;">, </span>36.6243<span style="color: #949494;">, </span>1.3599<span style="color: #949494;">, </span>2.6365<span style="color: #949494;">, </span>2.3227<span style="color: #949494;">, </span>24‚Ä¶</span></span>
<span><span class="co">#&gt; $ poster_path       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "/4KfgyzCgJeG0XJDbqNztdP730Pv.jpg"<span style="color: #949494;">, </span>"/7WsyChQLEftFiD‚Ä¶</span></span>
<span><span class="co">#&gt; $ release_date      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2024-10-17"<span style="color: #949494;">, </span>"2018-04-25"<span style="color: #949494;">, </span>"2012-04-25"<span style="color: #949494;">, </span>"1978-12-2‚Ä¶</span></span>
<span><span class="co">#&gt; $ title             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "LEGO Marvel Avengers: Mission Demolition"<span style="color: #949494;">, </span>"Avenger‚Ä¶</span></span>
<span><span class="co">#&gt; $ video             <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FAL‚Ä¶</span></span>
<span><span class="co">#&gt; $ vote_average      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 6.800<span style="color: #949494;">, </span>8.200<span style="color: #949494;">, </span>7.744<span style="color: #949494;">, </span>6.800<span style="color: #949494;">, </span>6.365<span style="color: #949494;">, </span>6.552<span style="color: #949494;">, </span>8.238<span style="color: #949494;">, </span>7.2‚Ä¶</span></span>
<span><span class="co">#&gt; $ vote_count        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 95<span style="color: #949494;">, </span>30490<span style="color: #949494;">, </span>31725<span style="color: #949494;">, </span>98<span style="color: #949494;">, </span>275<span style="color: #949494;">, </span>126<span style="color: #949494;">, </span>26301<span style="color: #949494;">, </span>23406<span style="color: #949494;">, </span>724<span style="color: #949494;">, </span>0‚Ä¶</span></span></code></pre></div>
<div class="section level4">
<h4 id="missing-data">Missing Data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h4>
<p>The <code>body$total_results</code> is 127, yet the
<code>body$results</code> only contain 20 rows.<br>
This is because <strong>body$total_pages = 7</strong> but each response
only returns <strong>one</strong> page.</p>
<p>To get the other pages, we need to specify an additional argument
<strong><code>page = n</code></strong> to the response, like so:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">page2_response</span> <span class="op">&lt;-</span> <span class="va">base_request</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://httr2.r-lib.org/reference/req_url.html" class="external-link">req_url_path_append</a></span><span class="op">(</span><span class="st">"search"</span>, <span class="st">"movie"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://httr2.r-lib.org/reference/req_url.html" class="external-link">req_url_query</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Avengers"</span>,</span>
<span>                page <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>                <span class="co">### NEW ARGUMENT</span></span>
<span>  <span class="fu"><a href="https://httr2.r-lib.org/reference/req_perform.html" class="external-link">req_perform</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://httr2.r-lib.org/reference/resp_body_raw.html" class="external-link">resp_body_json</a></span><span class="op">(</span>simplifyVector <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>results <span class="op">=</span> <span class="va">page2_response</span><span class="op">$</span><span class="va">results</span> <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest_wider.html" class="external-link">unnest_wider</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 20</span></span>
<span><span class="co">#&gt; Columns: 14</span></span>
<span><span class="co">#&gt; $ adult             <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FAL‚Ä¶</span></span>
<span><span class="co">#&gt; $ backdrop_path     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "/r5uAQQahZzcTYyPdlomDggyxHkV.jpg"<span style="color: #949494;">, </span>"/d1bKi2TRB8iFEz‚Ä¶</span></span>
<span><span class="co">#&gt; $ genre_ids         <span style="color: #949494; font-style: italic;">&lt;list&lt;list&gt;&gt;</span> [&lt;35, 14, 28&gt;]<span style="color: #949494;">, </span>[&lt;35, 27&gt;]<span style="color: #949494;">, </span>[&lt;10751, 16, 28, ‚Ä¶</span></span>
<span><span class="co">#&gt; $ id                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 538153<span style="color: #949494;">, </span>1353766<span style="color: #949494;">, </span>940543<span style="color: #949494;">, </span>385411<span style="color: #949494;">, </span>48230<span style="color: #949494;">, </span>109088<span style="color: #949494;">, </span>5217‚Ä¶</span></span>
<span><span class="co">#&gt; $ original_language <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "en"<span style="color: #949494;">, </span>"xx"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"el"<span style="color: #949494;">, </span>"ja"<span style="color: #949494;">, </span>"zh"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"fr"<span style="color: #949494;">, </span>"it"‚Ä¶</span></span>
<span><span class="co">#&gt; $ original_title    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Avengers of Justice: Farce Wars"<span style="color: #949494;">, </span>"È¢®ÊµÅÂ∞ëÂ•≥ÊÆ∫‰∫∫‰∫ã‰ª∂"<span style="color: #949494;">, </span>"LEGO‚Ä¶</span></span>
<span><span class="co">#&gt; $ overview          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "While trying to remain a good husband and father, S‚Ä¶</span></span>
<span><span class="co">#&gt; $ popularity        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.2177<span style="color: #949494;">, </span>0.3533<span style="color: #949494;">, </span>0.4869<span style="color: #949494;">, </span>0.0956<span style="color: #949494;">, </span>0.5639<span style="color: #949494;">, </span>0.3103<span style="color: #949494;">, </span>0.82‚Ä¶</span></span>
<span><span class="co">#&gt; $ poster_path       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "/yymsCwKPbJIF1xcl2ih8fl7OxAa.jpg"<span style="color: #949494;">, </span>"/alcvekyWjaRdCZ‚Ä¶</span></span>
<span><span class="co">#&gt; $ release_date      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2018-07-20"<span style="color: #949494;">, </span>"2024-09-22"<span style="color: #949494;">, </span>"2022-01-17"<span style="color: #949494;">, </span>"1975-01-0‚Ä¶</span></span>
<span><span class="co">#&gt; $ title             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Avengers of Justice: Farce Wars"<span style="color: #949494;">, </span>"A Brighter Summe‚Ä¶</span></span>
<span><span class="co">#&gt; $ video             <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FAL‚Ä¶</span></span>
<span><span class="co">#&gt; $ vote_average      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5.300<span style="color: #949494;">, </span>7.800<span style="color: #949494;">, </span>7.031<span style="color: #949494;">, </span>8.400<span style="color: #949494;">, </span>7.100<span style="color: #949494;">, </span>6.800<span style="color: #949494;">, </span>5.100<span style="color: #949494;">, </span>7.4‚Ä¶</span></span>
<span><span class="co">#&gt; $ vote_count        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 28<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>16<span style="color: #949494;">, </span>9<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>23<span style="color: #949494;">, </span>64<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>33<span style="color: #949494;">, </span>24<span style="color: #949494;">, </span>563<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>149<span style="color: #949494;">, </span>4‚Ä¶</span></span></code></pre></div>
<p>This ‚Äòsecond page‚Äô table contains the <em>next</em> 20 rows.<br>
To get all rows we need to repeat this until page = 7</p>
<p>To combine all of the pages from the search we can simply call the
wrapper function:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/search_movies.html">search_movies</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Avengers"</span>,</span>
<span>              auth_token <span class="op">=</span> <span class="fu"><a href="../reference/decrypt_auth_token.html">decrypt_auth_token</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 127</span></span>
<span><span class="co">#&gt; Columns: 14</span></span>
<span><span class="co">#&gt; $ adult             <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FAL‚Ä¶</span></span>
<span><span class="co">#&gt; $ backdrop_path     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "/rthMuZfFv4fqEU4JVbgSW9wQ8rs.jpg"<span style="color: #949494;">, </span>"/gHLs7Fy3DzLmLs‚Ä¶</span></span>
<span><span class="co">#&gt; $ genre_ids         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> [28, 12, 878]<span style="color: #949494;">, </span>[878, 28, 12]<span style="color: #949494;">, </span>[12, 28, 878]<span style="color: #949494;">, </span>[12, 8‚Ä¶</span></span>
<span><span class="co">#&gt; $ id                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 986056<span style="color: #949494;">, </span>24428<span style="color: #949494;">, </span>299536<span style="color: #949494;">, </span>299534<span style="color: #949494;">, </span>99861<span style="color: #949494;">, </span>1003596<span style="color: #949494;">, </span>10035‚Ä¶</span></span>
<span><span class="co">#&gt; $ original_language <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "en"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"en"<span style="color: #949494;">, </span>"en"‚Ä¶</span></span>
<span><span class="co">#&gt; $ original_title    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Thunderbolts*"<span style="color: #949494;">, </span>"The Avengers"<span style="color: #949494;">, </span>"Avengers: Infinity‚Ä¶</span></span>
<span><span class="co">#&gt; $ overview          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "After finding themselves ensnared in a death trap, ‚Ä¶</span></span>
<span><span class="co">#&gt; $ popularity        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 435.3441<span style="color: #949494;">, </span>36.6243<span style="color: #949494;">, </span>34.6673<span style="color: #949494;">, </span>24.3061<span style="color: #949494;">, </span>19.8977<span style="color: #949494;">, </span>18.372‚Ä¶</span></span>
<span><span class="co">#&gt; $ poster_path       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "/m9EtP1Yrzv6v7dMaC9mRaGhd1um.jpg"<span style="color: #949494;">, </span>"/RYMX2wcKCBAr24‚Ä¶</span></span>
<span><span class="co">#&gt; $ release_date      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2025-04-30"<span style="color: #949494;">, </span>"2012-04-25"<span style="color: #949494;">, </span>"2018-04-25"<span style="color: #949494;">, </span>"2019-04-2‚Ä¶</span></span>
<span><span class="co">#&gt; $ title             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Thunderbolts*"<span style="color: #949494;">, </span>"The Avengers"<span style="color: #949494;">, </span>"Avengers: Infinity‚Ä¶</span></span>
<span><span class="co">#&gt; $ video             <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FALSE<span style="color: #949494;">, </span>FAL‚Ä¶</span></span>
<span><span class="co">#&gt; $ vote_average      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 7.500<span style="color: #949494;">, </span>7.744<span style="color: #949494;">, </span>8.200<span style="color: #949494;">, </span>8.238<span style="color: #949494;">, </span>7.271<span style="color: #949494;">, </span>0.000<span style="color: #949494;">, </span>0.000<span style="color: #949494;">, </span>6.8‚Ä¶</span></span>
<span><span class="co">#&gt; $ vote_count        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 563<span style="color: #949494;">, </span>31725<span style="color: #949494;">, </span>30490<span style="color: #949494;">, </span>26301<span style="color: #949494;">, </span>23406<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>95<span style="color: #949494;">, </span>724<span style="color: #949494;">, </span>275<span style="color: #949494;">,</span>‚Ä¶</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dylan Novakowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
